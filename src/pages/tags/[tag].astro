---
import  { CollectionEntry, getCollection } from 'astro:content'
import BaseLayout from "../../components/BaseLayout.astro";
import type { InferGetStaticParamsType, InferGetStaticPropsType } from 'astro'

export async function getStaticPaths() {
    const allPosts = await getCollection('blog');
    const allTags = new Set<string>()
  allPosts.map(post => {
      post.data.tags && post.data.tags.map(tag => allTags.add(tag.toLowerCase()))
  })

  return Array.from(allTags).map(tag => {
    const filteredPosts = allPosts.filter((post)=> post.data.tags.includes(tag))
return ({
    params: { tag },
    posts: filteredPosts
  })
  })


}
type Params = InferGetStaticParamsType<typeof getStaticPaths>;

const { tag } = Astro.params;


---
<!-- <BaseLayout pageTitle={tag}>
  <p>Posts tagged with {tag}</p>

</BaseLayout> -->